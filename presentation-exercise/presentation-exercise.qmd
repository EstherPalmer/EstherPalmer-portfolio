---
title: "Presentation Exercise"
format: html
---

I got my graph from the pew research center https://www.pewresearch.org/short-reads/2025/12/15/our-favorite-data-visualizations-of-2025/sr_25-12-15_data-visualizations_1/
It looks at voters in 2020 and 2024 and determines how many switched their votes.
I picked it because my lab has previously used sankey plots to visualize some of our data and I've never made one before.
There wasn't a CSV I could download that I saw for this, however the % are labeled on the graph. So I made a spreadsheet including 100 hypothetical voters and used the labeled % to fill it in.


First I need to load packages
```{r}
library(here)
library(dplyr)
library(skimr)
library(tidyr) #I think ggalluvial needs this
library(ggplot2)
library(ggalluvial) #for sankey plots, ggplot2 extension
library(knitr)
```

Next I need to load my data
```{r}
data_location <- here::here("presentation-exercise", "2024_vote_data.csv")
vd <- read.csv(data_location)
```

Now for a quick look at my data
```{r}
summary(vd)
glimpse(vd)
skim(vd)
```
My data looks correct

Now lets see if I can make this plot!
```{r}
is_alluvia_form(vd)
#This is a check

ggplot(vd, aes(y = Freq, axis1 = Vote_2020, axis2 = Vote_2024)) + geom_alluvium(aes(fill = Vote_2020))

```
This is a good first plot! I want to see if I can add the blocks in and maybe the correct colors

```{r}
ggplot(vd, aes(y = Freq, axis1 = Vote_2020, axis2 = Vote_2024)) + geom_alluvium(aes(fill = Vote_2020)) + geom_stratum(width = 1/12) + geom_label(stat = "stratum", aes(label = after_stat(stratum))) + coord_flip()

```
I have managed to flip it on it's side! Although it's the wrong side. I have failed so far at colors.


```{r}
ggplot(vd, aes(y = Freq, axis1 = Vote_2020, axis2 = Vote_2024)) + 
    geom_alluvium(aes(fill = Vote_2020), decreasing = FALSE) + 
    geom_stratum(width = 1/12) + 
    geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
    scale_x_continuous(breaks = 1:2, labels = c("2020 Vote", "2024 Vote")) 
    
```
These axis labels do not match the data

```{r}
ggplot(vd, aes(y = Freq, axis1 = Vote_2024, axis2 = Vote_2020)) + 
    geom_alluvium(aes(fill = Vote_2020)) + 
    geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
    scale_x_continuous(breaks = 1:2, labels = c("2024 Vote", "2020 Vote")) +
    coord_flip() +
    ggtitle("The flow of voters and non-voters from 2020 to 2024")
```
So by removing the geom_stratum line I can keep the data labels correct, which is fine, just maybe further away from the original graph. I have solved the flipped y axis being weird by flipping the positions of all my variables.

```{r}
ggplot(vd, aes(y = Freq, axis1 = Vote_2024, axis2 = Vote_2020)) + 
    geom_alluvium(aes(fill = Vote_2020)) + 
    geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
    scale_x_continuous(breaks = 1:2, labels = c("2024 Vote", "2020 Vote")) +
    scale_fill_manual(values = c("#9AC0CD", "#e7e380ff", "#d9e2e2ff", "#fe4f1eff")) +
    coord_flip() +
    ggtitle("The flow of voters and non-voters from 2020 to 2024")
```
I figured out the colors, it just really hated when I put the variables in there for some reason

Here is the original graph:
[Original Graph](OriginalGraph.png)

Read in data in a useable form for not a sankey plot
```{r}
table_data_location <- here("presentation-exercise", "Table_data.csv")
td <- read.csv(table_data_location)
```

Now to put it in table form
```{r}
rename_columns <- c("Candidate", "2020 Vote", "2024 Vote", "% reoccuring voters", "% did not vote", "% voted for opponent")
kable(td, 
    col.names = rename_columns, 
    caption = "Percent of voters for each candidate in 2020/2024 and how many voted for the same candidate in 2024")

```